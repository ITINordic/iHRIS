(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["fhir-questionnaire"],{"0bc6":function(t,e,r){},4983:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"ihris-section",attrs:{id:"section-"+t.id}},[r("v-card",{staticClass:"mx-auto",attrs:{"max-width":"700",outlined:""}},[r("v-card-title",{staticClass:"primary darken-1 white--text text-uppercase font-weight-bold"},[t._v(t._s(t.label))]),t._l(t.errors,(function(e,a){return r("v-card-text",{key:a,staticClass:"error white--text font-weight-bold"},[t._v(t._s(e))])})),r("v-card-text",{staticClass:"my-3"},[t._t("default")],2)],2)],1)},i=[],n={name:"ihris-questionnaire-section",props:["id","label","description","path","constraints"],data:function(){return{isQuestionnaireGroup:!0,errors:[]}}},s=n,o=r("2877"),c=r("6544"),l=r.n(c),u=r("b0af"),d=r("99d9"),v=Object(o["a"])(s,a,i,!1,null,null,null);e["default"]=v.exports;l()(v,{VCard:u["a"],VCardText:d["c"],VCardTitle:d["d"]})},5105:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"d-none"},[r("v-text-field",{attrs:{readonly:"","hide-details":"",dense:"",disabled:""},model:{value:t.hiddenValue,callback:function(e){t.hiddenValue=e},expression:"hiddenValue"}})],1)},i=[],n={name:"ihris-hidden",props:["label","path","hiddenType","hiddenValue"],data:function(){return{qField:"value"+this.hiddenType,value:this.hiddenValue}}},s=n,o=r("2877"),c=r("6544"),l=r.n(c),u=r("8654"),d=Object(o["a"])(s,a,i,!1,null,null,null);e["default"]=d.exports;l()(d,{VTextField:u["a"]})},"91dd":function(t,e,r){"use strict";function a(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,r,n){e=e||"&",r=r||"=";var s={};if("string"!==typeof t||0===t.length)return s;var o=/\+/g;t=t.split(e);var c=1e3;n&&"number"===typeof n.maxKeys&&(c=n.maxKeys);var l=t.length;c>0&&l>c&&(l=c);for(var u=0;u<l;++u){var d,v,h,f,p=t[u].replace(o,"%20"),m=p.indexOf(r);m>=0?(d=p.substr(0,m),v=p.substr(m+1)):(d=p,v=""),h=decodeURIComponent(d),f=decodeURIComponent(v),a(s,h)?i(s[h])?s[h].push(f):s[h]=[s[h],f]:s[h]=f}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},b383:function(t,e,r){"use strict";e.decode=e.parse=r("91dd"),e.encode=e.stringify=r("e099")},e099:function(t,e,r){"use strict";var a=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,r,o){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"===typeof t?n(s(t),(function(s){var o=encodeURIComponent(a(s))+r;return i(t[s])?n(t[s],(function(t){return o+encodeURIComponent(a(t))})).join(e):o+encodeURIComponent(a(t[s]))})).join(e):o?encodeURIComponent(a(o))+r+encodeURIComponent(a(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function n(t,e){if(t.map)return t.map(e);for(var r=[],a=0;a<t.length;a++)r.push(e(t[a],a));return r}var s=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},e0c7:function(t,e,r){"use strict";var a=r("5530"),i=(r("0bc6"),r("7560")),n=r("58df");e["a"]=Object(n["a"])(i["a"]).extend({name:"v-subheader",props:{inset:Boolean},render:function(t){return t("div",{staticClass:"v-subheader",class:Object(a["a"])({"v-subheader--inset":this.inset},this.themeClasses),attrs:this.$attrs,on:this.$listeners},this.$slots.default)}})},f43a:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",{staticClass:"mx-auto",attrs:{"max-width":"700",outlined:""}},[r("v-card-title",{staticClass:"primary white--text text-uppercase font-weight-bold"},[t._v(t._s(t.label))]),t._l(t.errors,(function(e,a){return r("v-card-text",{key:a,staticClass:"error white--text font-weight-bold"},[t._v(t._s(e))])})),r("v-card-text",{staticClass:"my-3"},[t._t("default")],2)],2)},i=[],n={name:"ihris-questionnaire-group",props:["label","path","constraints"],data:function(){return{isQuestionnaireGroup:!0,errors:[]}}},s=n,o=r("2877"),c=r("6544"),l=r.n(c),u=r("b0af"),d=r("99d9"),v=Object(o["a"])(s,a,i,!1,null,null,null);e["default"]=v.exports;l()(v,{VCard:u["a"],VCardText:d["c"],VCardTitle:d["d"]})},f977:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{staticClass:"my-3"},[r("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[t._t("default"),r("v-overlay",{attrs:{value:t.overlay}},[r("v-progress-circular",{attrs:{size:"50",color:"primary",indeterminate:""}}),r("v-btn",{attrs:{icon:""},on:{click:function(e){t.overlay=!1}}},[r("v-icon",[t._v("mdi-close")])],1)],1),r("v-navigation-drawer",{staticClass:"primary darken-1 white--text",staticStyle:{"z-index":"3"},attrs:{app:"",right:"",permanent:"",clipped:""}},[r("v-list",{staticClass:"white--text"},[r("v-list-item",[t.isEdit?r("v-btn",{staticClass:"accent darken-1",attrs:{dark:""},on:{click:function(e){return t.$router.go(-1)}}},[r("v-icon",{attrs:{light:""}},[t._v("mdi-content-save")]),r("span",[t._v("Back")])],1):t._e(),r("v-spacer"),t.valid?r("v-btn",{staticClass:"success darken-1",attrs:{dark:"",disabled:!t.valid},on:{click:function(e){return t.processFHIR()}}},[r("v-icon",{attrs:{light:""}},[t._v("mdi-content-save")]),r("span",[t._v("Save")])],1):r("v-btn",{staticClass:"warning",attrs:{dark:""},on:{click:function(e){return t.$refs.form.validate()}}},[r("v-icon",{attrs:{light:""}},[t._v("mdi-content-save")]),r("span",[t._v("Save")])],1)],1),r("v-divider",{attrs:{color:"white"}}),t.sectionMenu?r("v-subheader",{staticClass:"white--text"},[r("h2",[t._v("Sections")])]):t._e(),t._l(t.sectionMenu,(function(e){return r("v-list-item",{key:e.id,attrs:{href:"#section-"+e.id}},[r("v-list-item-content",{staticClass:"white--text"},[r("v-list-item-title",{staticClass:"text-uppercase"},[r("h4",[t._v(t._s(e.title))])]),r("v-list-item-subtitle",{staticClass:"white--text"},[t._v(t._s(e.desc))])],1)],1)}))],2)],1)],2)],1)},i=[],n=(r("a623"),r("7db0"),r("4160"),r("d3b7"),r("ac1f"),r("1276"),r("159b"),r("b85c")),s=r("b383"),o={name:"ihris-questionnaire",props:["id","url","title","description","purpose","section-menu","view-page","edit","constraints"],data:function(){return{fhir:{},loading:!1,overlay:!1,isEdit:!1,valid:!0,advancedValid:!0}},created:function(){},methods:{processFHIR:function(){var t=this;if(this.$refs.form.validate(),this.valid){this.advancedValid=!0,this.overlay=!0,this.loading=!0;var e=function e(r,a,i){i||(i={}),a.forEach((function(a){var s=r,o={};if(a.isArray);else if(a.isQuestionnaireGroup){var c={linkId:a.path,text:a.label,item:[]};s.push(c),s=c.item}else if(a.qField){var l;i.hasOwnProperty(a.path)?l=i[a.path]:(l={linkId:a.path,answer:[]},i[a.path]=l,s.push(l));var u={};if(u[a.qField]=a.value,l.answer.push(u),a.constraints){a.errors=[];var d,v=a.constraints.split(","),h=Object(n["a"])(v);try{for(h.s();!(d=h.n()).done;){var f=d.value;if(t.constraints[f]){var p=t.$fhirpath.evaluate(a.value,t.constraints[f].expression);p.every(Boolean)||(a.errors.push(t.constraints[f].human),t.advancedValid=!1)}}}catch(C){h.e(C)}finally{h.f()}}}if(a.$children&&e(s,a.$children,o),a.isQuestionnaireGroup&&a.constraints){a.errors=[];var m,b=a.constraints.split(","),y=Object(n["a"])(b);try{for(y.s();!(m=y.n()).done;){var g=m.value;if(t.constraints[g]){var x=t.$fhirpath.evaluate(s,t.constraints[g].expression);x.every(Boolean)||(a.errors.push(t.constraints[g].human),t.advancedValid=!1)}}}catch(C){y.e(C)}finally{y.f()}}}))};if(this.fhir={resourceType:"QuestionnaireResponse",questionnaire:this.url,status:"completed",item:[]},e(this.fhir.item,this.$children),!this.advancedValid)return this.overlay=!1,this.loading=!1,void this.$store.commit("setMessage",{type:"error",text:"There were errors on the form."});console.log("SAVE",this.fhir),fetch("/fhir/QuestionnaireResponse?"+s.stringify(this.$route.query),{method:"POST",headers:{"Content-Type":"application/fhir+json"},redirect:"manual",body:JSON.stringify(this.fhir)}).then((function(e){201===e.status&&(e.json().then((function(e){var r;if(t.overlay=!1,t.loading=!1,t.viewPage){if(e.meta.tag){var a=e.meta.tag.find((function(t){return"http://ihris.org/fhir/tags/resource"===t.system}));a&&a.code&&(r=a.code)}if(!r&&e.subject&&e.subject.reference&&(r=e.subject.reference),r){var i=r.split("/");i=i[1]?i[1]:r,t.$router.push({name:"resource_view",params:{page:t.viewPage,id:i}})}}r||t.$router.push({name:"home"})})),t.$store.commit("setMessage",{type:"success",text:"Update successful."}))})).catch((function(e){console.log(e),t.overlay=!1,t.loading=!1,t.$store.commit("setMessage",{type:"error",text:"Failed to update data."})}))}}}},c=o,l=r("2877"),u=r("6544"),d=r.n(u),v=r("8336"),h=r("a523"),f=r("ce7e"),p=r("4bd4"),m=r("132d"),b=r("8860"),y=r("da13"),g=r("5d23"),x=r("f774"),C=r("a797"),_=r("490a"),w=r("2fa4"),V=r("e0c7"),j=Object(l["a"])(c,a,i,!1,null,null,null);e["default"]=j.exports;d()(j,{VBtn:v["a"],VContainer:h["a"],VDivider:f["a"],VForm:p["a"],VIcon:m["a"],VList:b["a"],VListItem:y["a"],VListItemContent:g["a"],VListItemSubtitle:g["b"],VListItemTitle:g["c"],VNavigationDrawer:x["a"],VOverlay:C["a"],VProgressCircular:_["a"],VSpacer:w["a"],VSubheader:V["a"]})}}]);
//# sourceMappingURL=fhir-questionnaire.be351137.js.map